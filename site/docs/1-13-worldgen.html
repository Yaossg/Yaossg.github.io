<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-1-13-worldgen">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">浅析 1.13 世界生成 | Yaossg&#x27;s Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://yaossg.com/site/docs/1-13-worldgen"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="浅析 1.13 世界生成 | Yaossg&#x27;s Site"><meta data-rh="true" name="description" content="摘要"><meta data-rh="true" property="og:description" content="摘要"><link data-rh="true" rel="icon" href="/site/img/sausage.png"><link data-rh="true" rel="canonical" href="https://yaossg.com/site/docs/1-13-worldgen"><link data-rh="true" rel="alternate" href="https://yaossg.com/site/docs/1-13-worldgen" hreflang="en"><link data-rh="true" rel="alternate" href="https://yaossg.com/site/docs/1-13-worldgen" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/site/blog/rss.xml" title="Yaossg&#39;s Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/site/blog/atom.xml" title="Yaossg&#39;s Site Atom Feed">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/site/assets/css/styles.83f2a07a.css">
<link rel="preload" href="/site/assets/js/runtime~main.b1ff4dae.js" as="script">
<link rel="preload" href="/site/assets/js/main.12a8b356.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/site/"><div class="navbar__logo"><img src="/site/img/sausage-128.png" alt="Yaossg&#x27;s Site" class="themedImage_ToTc themedImage--light_HNdA"><img src="/site/img/sausage-128.png" alt="Yaossg&#x27;s Site" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Yaossg&#x27;s Site</b></a><a class="navbar__item navbar__link" href="/site/blog">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/site/docs">Doc</a><a class="navbar__item navbar__link" href="/site/friends">Friends</a></div><div class="navbar__items navbar__items--right"><a href="https://space.bilibili.com/282144386" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Bilibili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Yaossg/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/site/docs">香肠的文档站</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/site/docs/1-13-worldgen">浅析 1.13 世界生成</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/site/docs/biome">🌏 再析世界生成：生物群系</a><button aria-label="Toggle the collapsible sidebar category &#x27;🌏 再析世界生成：生物群系&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/site/docs/cnss/0">🖥️ CNSS Recruit 2022 Dev</a><button aria-label="Toggle the collapsible sidebar category &#x27;🖥️ CNSS Recruit 2022 Dev&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/site/docs/lambda">Introduction to Lambda Calculus</a><button aria-label="Toggle the collapsible sidebar category &#x27;Introduction to Lambda Calculus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/site/docs/rc9gn">RC9GN 第一季忍者指南语录</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/site/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">浅析 1.13 世界生成</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>浅析 1.13 世界生成</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="摘要">摘要<a class="hash-link" href="#摘要" title="Direct link to heading">​</a></h2><p><strong>世界生成</strong>是我的世界的一个重要内容。Minecraft 在发展，世界生成的代码却在很长的一段时间里没有发生太大的变化，而 1.13 正是对这一切进行变革的一个版本。在之后各个版本的世界生成中，1.13 版本的核心价值一直在不断地体现。这就是为什么会有这篇文章：因为这是一次<strong>划时代</strong>的更新。本文从世界生成的各个方面，逐一探讨其中的奥秘，揭开新版世界生成神秘复杂的面纱。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="引子为什么">引子：为什么？<a class="hash-link" href="#引子为什么" title="Direct link to heading">​</a></h2><p><strong>世界生成</strong>（<strong>World Generation</strong>, or <strong>WorldGen</strong> for short）是我的世界的一个重要内容。Minecraft 在发展，世界生成的代码却在很长的一段时间里没有发生太大的变化，而 1.13 正是对这一切进行变革的一个版本。那么为什么我们需要推翻一个使用这么长时间的、看似并没有太大问题的世界生成机制呢？我们为什么要这样变？这样变又有什么好处呢？</p><p>要解答这些问题，就要从旧版的世界生成说起，在这里，我不能把 1.12 及以前的地形生成解析一遍，在文末的相关链接我给出了土球的一个简要解析，供读者参考。也许在实际的游戏中，我们很难看出什么区别，但潜移默化间，Mojang 已经向前迈出了一大步。</p><p>这次 Mojang 代码的重构采用了全新的设计模式，增加了代码的可扩展性，主要体现在：</p><ul><li>将世界生成的功能被集中在了区块生成器和生物群系两部分上面，而不是离散在方方面面，更便于对代码之间的关系进行分析。</li><li>细化了分类和世界生成的步骤，将不同的功能分离开，实现逻辑分层和模块化，代码更加清晰，复用性更高。<ul><li>比如把定位和生成分离，灵活组合，告别了过去一写特性就花半天写定位代码或复制定位代码的冗余。</li><li>因为步骤被细化了，更加利于分配任务，所以世界生成可以异步了。</li></ul></li><li>采用大量函数式接口，助力函数式大潮，让传递代码成为一种时尚。</li><li>采用了全新的设计模式，告别了过去Mojang一贯的代码风格，打破了我们的刻板印象。<ul><li>如<code>(X-XType)</code>模式，即用<code>X</code>表示对象本身，实现它的功能，而<code>XType</code>描述这类对象性质，提供对象的工厂方法。</li><li>如<code>(X-XConfig)</code>模式，即用<code>X</code>实现功能，而用<code>XConfig</code>来传递实现此功能的参数，通过泛型避免不同行为的参数不同和大量无意义的类型转换。</li><li>如有限状态机，用以表示区块生成的不同阶段和更加灵活地方式区分生物群系，删除了过去的硬编码。</li></ul></li><li>统一化的世界生成接口，让所有生成的装饰都归于一个概念——特性。避免了以往的混乱不堪、互相踩脚的弊端。</li><li>开放了生物群系的接口，提供了生物群系的<code>Builder</code>，让你体验搭积木式的快感，让你不用Forge也能加特性。</li></ul><p>在之后各个版本的世界生成中，1.13 版本的核心价值一直在不断地体现。这就是为什么会有这篇文章：因为这是一次<strong>划时代</strong>的更新。下面我们将从世界生成的各个方面，逐一探讨其中的奥秘，揭开新版世界生成神秘复杂的面纱。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="区块生成概述">区块生成概述<a class="hash-link" href="#区块生成概述" title="Direct link to heading">​</a></h2><blockquote><p>区块（Chunk）是Minecraft世界里一个大小为 16×256×16 的部分 ——Minecraft 中文维基</p></blockquote><p>一个存档有多个维度，每个维度都有一个世界，世界是由一个个区块组成的，所以生成世界的实质就是生成区块。</p><p>在过去，区块生成分为 Generation 和 Population 两个阶段，而在 1.13 以后，不再这样笼统的区分，每个区块都拥有一个状态，每个状态都表示他<strong>已经完成</strong>的某一个任务，并提供下一个任务，以此实现<strong>异步</strong>的区块生成。</p><p>按顺序，它们分别是：</p><table><thead><tr><th>状态</th><th>翻译</th></tr></thead><tbody><tr><td>empty</td><td>空</td></tr><tr><td>base</td><td>基础</td></tr><tr><td>carved</td><td>镂空</td></tr><tr><td>liquid_carved</td><td>流体镂空</td></tr><tr><td>decorated</td><td>装饰</td></tr><tr><td>lighted</td><td>光照</td></tr><tr><td>mobs_spawned</td><td>生物生成</td></tr><tr><td>finalized</td><td>收尾</td></tr><tr><td>fullchunk</td><td>完整区块</td></tr><tr><td>postprocessed</td><td>处理后</td></tr></tbody></table><p>前面的阶段属于样板（proto）区块，而最后两个属于存档（level）区块，后者已经可以序列化为 NBT 了。这个两种类型定义在<code>ChunkStatus.Type</code>枚举中。</p><p><strong>[提示]</strong> 为了更加直观的观看区块生成时所处的不同状态，可以观看 1.14 世界加载时的动画，其中不同的颜色代表不同的状态，可以说没有 1.13 的变革也不会有 1.14 的进步。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="区块生成任务">区块生成任务<a class="hash-link" href="#区块生成任务" title="Direct link to heading">​</a></h2><p>接下来详细讲解每一个各个<strong>任务</strong>的内容。</p><p><strong>[注意]</strong> 再说一遍是对应的<strong>任务</strong>的内容，其他内容不再此列。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="基础">基础<a class="hash-link" href="#基础" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="选定生物群系">选定生物群系<a class="hash-link" href="#选定生物群系" title="Direct link to heading">​</a></h4><p>生物群系选定是区块生成的第一步，所以也是世界生成的第一步。因此重要程度不言而喻。随着版本更迭，这一部分变化也很大。有关这一部分的内容，请参考我的新作。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="高度图">高度图<a class="hash-link" href="#高度图" title="Direct link to heading">​</a></h4><p>高度图记录每个<code>(x, z)</code>下最高的方块，用于描述地形的起伏升降，根据“最高方块”的标准不同，高度图分为以下几种，注意<strong>且</strong>的优先级是高于<strong>或</strong>的。其中有<code>_WG</code>后缀的都是为世界生成准备的。</p><table><thead><tr><th>枚举名</th><th>含义：最高的 <em>非</em> (...) 的方块</th></tr></thead><tbody><tr><td><code>LIGHT_BLOCKING</code></td><td>空气 <strong>或</strong> <em>透明</em></td></tr><tr><td><code>MOTION_BLOCKING</code></td><td>空气 <strong>或</strong> <em>允许移动</em> <strong>且</strong> <em>不包含流体</em></td></tr><tr><td><code>MOTION_BLOCKING_NO_LEAVES</code></td><td>空气 <strong>或</strong> <em>树叶</em> <strong>或</strong> <em>允许移动</em> <strong>且</strong> <em>不包含流体</em></td></tr><tr><td><code>OCEAN_FLOOR</code></td><td>空气 <strong>或</strong> <em>允许移动</em></td></tr><tr><td><code>OCEAN_FLOOR_WG</code></td><td>空气 <strong>或</strong> 流体</td></tr><tr><td><code>WORLD_SURFACE</code></td><td>空气</td></tr><tr><td><code>WORLD_SURFACE_WG</code></td><td>空气</td></tr></tbody></table><p><strong>[说明]</strong></p><ul><li>透明：即不透明度为0的方块，不透明度会影响光的传递</li><li>树叶：即拥有<code>minecraft:leaves</code>标签（tag）的方块</li><li>允许移动：允许实体进入方块并在其中移动，比如树苗、按钮、花盆、地毯</li><li>不包含流体：即该方块里面没有流体浸入，比如正常的梯子，就属于 允许移动 且 不包含流体，但是如果梯子里面倒桶水，它就“包含流体”了</li></ul><p>这些类型都可以在<code>Heightmap.Type</code>找到，这两种用途对应枚举<code>Heightmap.Usage</code>的值。</p><p>为了构造地表，我们需要一些高度图，高度图怎么得来，生成随机数？那样生成的地形七上八下支离破碎，为了确保地形看上去更加平滑真实，就需要用到噪声算法，可以最大程度保证不出现极端的高度跳跃。</p><p>上面说到的高度图，指的是世界生成专用的高度图，而其他的高度图，则是在每个区块生成的任务<strong>执行前</strong>进行更新。区块生成的前面四个阶段都不会更新高度图，而剩下的都会更新高度图。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="地表构造器">地表构造器<a class="hash-link" href="#地表构造器" title="Direct link to heading">​</a></h4><p>有了高度图，我们就可以据此生成地表了。新版本生成地表的工具便是地表构造器。</p><p><strong>[注意]</strong> 地表构造器（<code>ISurfaceBuilder</code>）的<code>Builder</code>跟通常的<code>Builder</code>不同，它本身就是功能性的一个类，这个<code>Build</code>指的是地形的构造，而不是对象的构造</p><p>地表构造器就是原来的<code>Biome#genTerrainBlocks</code>，独立出来之后，它变得更加灵活、复用性更强。</p><p>而地表构造器配置提供至少两个信息，即顶层（top）方块和中层（middle）方块，比如在普通的平原生物群系，顶层（top）方块就是草方块，而中层方块则是泥土方块，此外还会有水底方块的信息（比如默认为砂砾）。</p><p>基岩的生成代码独立出来，而不是像过去一样包含在<code>Biome#genTerrainBlocks</code>的代码里，这也就意味着你不会因为不谨慎的覆盖而导致基岩的生成被“取消”了。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="镂空流体镂空">镂空、流体镂空<a class="hash-link" href="#镂空流体镂空" title="Direct link to heading">​</a></h3><p>所谓镂空就是钻洞注水，采用<code>IWorldCarver</code>。</p><p><code>GenerationStage.Carving</code>枚举的<code>AIR</code>表示镂空，<code>LIQUID</code>表示流体镂空。</p><p>镂空是生物群系相关的，因为镂空器是从生物群系那里取得的。</p><p><strong>[注意]</strong> GenerationStage 中的那个与旧版的 Generation 无关。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="装饰">装饰<a class="hash-link" href="#装饰" title="Direct link to heading">​</a></h3><p>装饰可以说是整个地形生成中最为重要的一部分了，你不想看到光秃秃的世界吧，在这个阶段，所有可掉落掉落的方块都会立即掉落（但是镂空阶段却不会，这也就是为什么原版生成的地图有这么多浮沙）。</p><p>装饰的载体是生物群系，它实际上就是从原来的<code>Biome#decorate</code>独立而成，独立出来之后，它变得更加灵活、复用性更强，不过在过去，有一个叫装饰器（decorator）的东西，被彻底移除了，现在用特性来统一管理所有生物群系特性，分为三类。</p><table><thead><tr><th>类别</th><th>说明</th></tr></thead><tbody><tr><td>特性</td><td>无</td></tr><tr><td>花</td><td>可以通过用骨粉催熟后天生成的特性<br><strong>特殊之处</strong>：有一个专门的列表以便骨粉迭代</td></tr><tr><td>结构</td><td>它们的一些数据会被单独保存在世界里面，我们会在下面单独谈到<br><strong>特殊之处</strong>：有一个专门的映射以便保存相关配置<br>必须要调用两个方法来注册，分别加入特性列表和添加配置的映射</td></tr></tbody></table><p><code>GenerationStage.Decoration</code>枚举里面的值列出了装饰的所有阶段，依次是：</p><table><thead><tr><th>状态</th><th>翻译</th><th>例子</th></tr></thead><tbody><tr><td>raw_generation</td><td>原生生成</td><td>目前只有末地岛</td></tr><tr><td>local_modifications</td><td>本地修饰</td><td>湖、岩浆湖、冰山、苔石堆</td></tr><tr><td>underground_structures</td><td>地下结构</td><td>略，<strong>特例</strong>：地牢（它只是特性而不是结构）</td></tr><tr><td>surface_structures</td><td>地表结构</td><td>略，<strong>特例</strong>：冰刺地区的冰刺和冰道</td></tr><tr><td>underground_ores</td><td>地下矿石</td><td>略</td></tr><tr><td>underground_decoration</td><td>地下装饰</td><td>化石、萤石、下界火、岩浆、蠹虫刷怪蛋<br>下界蘑菇（主世界蘑菇在下一个阶段生成）</td></tr><tr><td>vegetal_decoration</td><td>植物装饰</td><td>略，<strong>特例</strong>：<br>主世界蘑菇（因为<del>蘑菇不是植物</del>下界蘑菇在上一个阶段生成）<br>单格的水和岩浆（常在矿洞里面形成瀑布，<br>鬼知道Mojang为什么要把它放到这里面）</td></tr><tr><td>top_layer_modification</td><td>顶层修饰</td><td>在温度足够低的位置生成冰雪</td></tr></tbody></table><p>生成装饰时，特性往往要借助定位器的协助，定位器可以根据周围的地形调整生成的位置，而复合特性就包含了定位器和特性，在生成时就自带定位了。</p><p><strong>[提示]</strong> 定位器常常会用到前面说的高度图来确保特性在地表生成。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="光照">光照<a class="hash-link" href="#光照" title="Direct link to heading">​</a></h3><p>此时区块的方块已经生成完成，但是光照没有更新，所以根据目前区块中方块的光照，当然还有天空的光照来更新区块的光照。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="生物生成">生物生成<a class="hash-link" href="#生物生成" title="Direct link to heading">​</a></h3><p>为了让玩家在进入游戏后里面看到生物，这个阶段将会<strong>预先</strong>生成一些生物。</p><p>所以下界和末地在这个阶段什么都不做。因为就算是空的也没关系，过会就有了嘛，反正都是怪物。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="收尾">收尾<a class="hash-link" href="#收尾" title="Direct link to heading">​</a></h3><p>确保更新高度图。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="完整区块处理后">完整区块、处理后<a class="hash-link" href="#完整区块处理后" title="Direct link to heading">​</a></h3><p>什么都不做，直接由相关代码设置为此状态。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="结束了结束了">结束了？结束了。<a class="hash-link" href="#结束了结束了" title="Direct link to heading">​</a></h2><p>当然了，最后两个阶段并不是真的什么都不做，而是由别人做，下面介绍一下相关代码：</p><p>当到完整区块的阶段时，表示一个<code>Chunk</code>对象已经完成了构造。</p><p>而在玩家正式进入世界之前，还需要一些处理。</p><p>当一个区块周围的 8 个区块都生成完毕，那么它会：</p><ul><li>对区块内的一些方块状态进行更新。</li><li>更新需要 tick 的方块和流体。</li><li>检验区块里的<code>TileEntity</code>。</li></ul><p>在收尾完成之后，<code>Chunk#isPopulated</code>将会返回<code>true</code>。</p><p><strong>[注意]</strong>  这个 Populate 和旧版也没多大联系，硬要说，就是都表示这个区块的生成已经完成。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="生物群系">生物群系<a class="hash-link" href="#生物群系" title="Direct link to heading">​</a></h2><p>有关这一部分的内容，请参考我的新作。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="结构生成">结构生成<a class="hash-link" href="#结构生成" title="Direct link to heading">​</a></h2><p><code>Structure -&gt; StructureStart -&gt; StructurePiece</code></p><p>如图，在生成结构（你已经知道结构也是特性的一种，对吧？）时，先判断是否为正确的生物群系，接着以中心区块（Feature本应生成于的区块）为正方形的中心，结构尺度（size，单位是区块，这也就是为什么不译作大小）的两倍加一为正方形的边长，在这些区块中寻找一个合适的区块作为整个结构的起点，这个起点本身的大小不能越过正方形的边界。</p><p>结构起点储存这个这个结构的所有可能有的部分。而在确认此处要生成结构之后，会把任务交给结构起点，结构生成就正式开始了。</p><p>在结构起点的构造器里面，第一个阶段将会被调用。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="buildcomponent"><code>buildComponent</code><a class="hash-link" href="#buildcomponent" title="Direct link to heading">​</a></h3><p>在这个阶段，从起点开始延伸，结构的各个组成环节产生，但是此时此刻，方块不会被放置，而是形成一个个 Component，为了便于讲解，我译作（结构生成）任务，把所有 Component 成为任务列表。</p><p>为了更好地说明，我们用村庄做例子。</p><p><strong>[说明]</strong> 村庄是一个易于理解的，常见的例子，但是 Mojang 的源代码确实太难看。我不原封不动的解析，而是把真正有意义的内容讲出。</p><ul><li>在最开始的时候，只有一个水井任务被加入任务列表。</li><li>水井的<code>buildComponet</code>里面加入了朝向四个方面路的任务，我们有四条“开路”。</li><li>现在我们对每一条路都<code>buildComponet</code>，毫无疑问路会延伸，我们把已经build之后的路从我们的开路列表里面移除，同时刚才有新增了几个开路。</li><li>路在延伸的时候，有一定的几率添加一个屋子到任务列表，如果是在路边，路还能继续延伸，否则路到这就变成死路了。</li><li>也有可能会生成岔路，岔路也会被放进开路的列表。</li><li>如果生成屋子和岔路都生成失败了，那么还有一定几率拐弯。</li><li>如果上面的尝试都失败了，那么这条路就成了死路。</li></ul><p><strong>[说明]</strong> 上面的原理揭示了为什么把村庄的size设置得非常大(比如正常=0，超平坦=1，我设置为65535)并不会让村庄真的变得非常大，因为村庄的生存实际上很大程度受到路的限制，一旦没路了，村庄就不会生成了。</p><p>同样的原理对于下界堡垒也适用，但是下界堡垒相对来说更加复杂多变。</p><p>为了防止发生两个部分撞在一起的悲剧，所有的过程都是被监管的，只要这个部分太大，那么任务就无法被添加，但是这只对同一个结构有效，如果不巧有两个结构，那就无法避免地其中一个会被另外一个替换方块，这可能是我的世界极少数资源与区块加载顺序联系在一起的实例，而造成的影响也几乎是可以忽略不计的，<del>除非他把你的末地门弄坏了2333</del>。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="addcomponentparts"><code>addComponentParts</code><a class="hash-link" href="#addcomponentparts" title="Direct link to heading">​</a></h3><p><del>真正破坏末地门是在这里（雾。</del></p><p>在这个阶段，所有结构的方块被放置，<strong>应</strong>始终确保方块不超出结构的边界，同时也要保证方向的正确，返回的<code>boolean</code>表示它的生成是否成功，此后，还会对这个结构的大小进行重算。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="模板">模板<a class="hash-link" href="#模板" title="Direct link to heading">​</a></h2><blockquote><p>模板是已经被证明C++最强大的功能之一，但却常常被人们忽视、误解或误用。</p><p> ——Nicolai M. Josuttis《C++Templates》</p></blockquote><p>咳咳，串味了，此模板非彼模板。</p><p>在生成结构的时候，你是否对不断地调用方法放置方块地硬编码感到厌倦？模板可是说是你的大救星，“但却常常被人们<strong>忽视、误解</strong>或误用”。早在 1.9，Mojang 就引入了结构方块，随之而来的就是 template，可以说，结构从硬编码转为 template 可以说是大势所趋。那么，模板究竟是怎样存储结构数据，又是怎样呈现在世界上的呢？</p><p>模板最重要的三个内容便是方块、实体、大小，其中方块和实体的位置都是相对于这个结构的原点—— xyz 都最小的那一个角表示的。这也就意味着模板易于在任意区域建造。同时，模板同样储存了方块和实体的朝向，这也就意味着模板本身具有方向性——好在模板还有一个特点，那就是易于旋转或者镜像。在模板建造在世界上的同时，当中的方块也会更新，来保证结构的功能性。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="调色盘">调色盘<a class="hash-link" href="#调色盘" title="Direct link to heading">​</a></h3><p>往往一个模板里面会有很多完全相同的方块，如果这些方块都一一存入NBT，实在是有些浪费空间。因此Mojang引入了调色盘这个概念，说白了就是一个字典——给<code>Blockstate</code>编号，按照读入的先后，从0开始依次编号，与以前的数字id不同，这只是一个临时编号，仅仅对于这个结构有效，此外，这个id是NBT无关的，即它不表示<code>IBlockstate</code>所在的<code>TileEntity</code>所携带的NBT。</p><p><strong>[提示]</strong> 如果你对原版的区块格式有所了解，你就会知道，实际上区块也是有调色盘的。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="templatestructurepiece"><code>TemplateStructurePiece</code><a class="hash-link" href="#templatestructurepiece" title="Direct link to heading">​</a></h3><p>为了更方便的使用模板生成结构，Mojang 准备了这个类。</p><p>其他的不用说，我们把眼光投向<code>TemplateStructurePiece#handleDataMarker</code>。</p><p>嘿，<code>DataMaker</code>是什么？</p><p>不知道大家注意到没有，结构方块的四种模式里面，有一种叫做“数据”，这就是所谓的<code>DataMaker</code>，它填补了结构中无法携带特殊信息的不足，通过这个，我们能够吧代码和模板联系起来，让模板“调用”代码。</p><p><code>Data</code>模式的结构方块在存入结构时会被自动替换为结构虚空。</p><p>我们不妨以海底废墟为例：</p><div class="language-Java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">protected void handleDataMarker(String function, BlockPos pos, IWorld worldIn, Random rand, MutableBoundingBox sbb) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     if (&quot;chest&quot;.equals(function)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        worldIn.setBlockState(pos, Blocks.CHEST.getDefaultState().with(BlockChest.WATERLOGGED, Boolean.valueOf(worldIn.getFluidState(pos).isTagged(FluidTags.WATER))), 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TileEntity tileentity = worldIn.getTileEntity(pos);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (tileentity instanceof TileEntityChest) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ((TileEntityChest)tileentity).setLootTable(this.field_204040_h ? LootTableList.CHESTS_UNDERWATER_RUIN_BIG : LootTableList.CHESTS_UNDERWATER_RUIN_SMALL, rand.nextLong());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     } else if (&quot;drowned&quot;.equals(function)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EntityDrowned entitydrowned = new EntityDrowned(worldIn.getWorld());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        entitydrowned.enablePersistence();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        entitydrowned.moveToBlockPosAndAngles(pos, 0.0F, 0.0F);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        entitydrowned.onInitialSpawn(worldIn.getDifficultyForLocation(pos), (IEntityLivingData)null, (NBTTagCompound)null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        worldIn.spawnEntity(entitydrowned);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (pos.getY() &gt; worldIn.getSeaLevel()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           worldIn.setBlockState(pos, Blocks.AIR.getDefaultState(), 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           worldIn.setBlockState(pos, Blocks.WATER.getDefaultState(), 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在这里，根据不同的函数（<code>function</code>），调用了不同的代码，比如生成箱子、生成溺尸。无一例外的，他们往往对附近环境进行的判断和适应，来达到更好的结构生成效果，这是单纯的 NBT 数据无法做到的。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="维度与世界类型">维度与世界类型<a class="hash-link" href="#维度与世界类型" title="Direct link to heading">​</a></h2><p>这一部分看似已经超出了狭义的“世界生成”，但其实它们有与世界生成千丝万缕的联系。</p><p>这里指简单介绍了几个方法，在新的教程里，有关于这一部分更详细的介绍。</p><hr><p><code>Dimension#createChunkGenerator</code> 和 <code>IForgeWorldType#createChunkGenerator</code></p><p>默认行为：前者返回当前维度的区块生成器，后者调用前者。其中前者被废弃要求调用后者。</p><p>因为返回了一个区块生成器（而里面实际上就包含了生物群系提供器），所以决定了这个世界的地形生成。</p><p>自定义维度或自定义世界类型时应当覆盖。</p><hr><p><code>IForgeWorldType#getBiomeLayer</code></p><p>略，见新教程。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="应用自定义">应用：自定义<a class="hash-link" href="#应用自定义" title="Direct link to heading">​</a></h2><p>唉唉唉，等一下，你确定这不是 Forge 干的事情？</p><p>是的，新版的矿物生成完全不需要 Forge 插手即可实现自定义<del>于是Forge就真的懒到没有插手</del>，其他相关内容 Forge 也少了很多的话语权，大量 Forge 钩子消失，甚至出现了存在但未被使用的 Forge 事件（来自旧版本），可见原版对 Forge 的冲击。下面的内容尽量少的提及 Forge 知识，但不会回避 Forge。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="自定义矿物生成">自定义矿物生成<a class="hash-link" href="#自定义矿物生成" title="Direct link to heading">​</a></h3><p>我们在mod主类的构造器里这么写：</p><div class="language-Java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Biomes.PLAINS.addFeature(GenerationStage.Decoration.UNDERGROUND_ORES, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Biome.createCompositeFeature(Feature.MINABLE, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new MinableConfig(MinableConfig.IS_ROCK, Blocks.GOLD_BLOCK.getDefaultState(), 9), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Biome.COUNT_RANGE, new CountRangeConfig(20, 0, 0, 64)));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我就完成了矿物生成的注册，上面的代码可以让金块像铁矿一样地在平原的地下生成，我们不妨来解析一下。</p><p><code>Biomes.PLAINS</code>，即平原，在实际应用中，我们往往会用<code>ForgeRegistries.BIOMES.forEach(biome -&gt; biome.add...());</code>来向所有生物群系种添加，但是你就得找一个所有模组<code>Biome</code>都已经全部注册完成的地方调用了。</p><p><code>addFeature</code>可以用于添加特性或是花，<code>addCarver</code>则是添加镂空器，<code>addStructure</code>添加结构。我们直接调用了<code>Biome</code>的工厂方法<code>createCompositeFeature</code>创建复合特性，使用了<code>Feature</code>预定义的minable特性及其相应配置，配合<code>Biome</code>里面的预定义的定位器及其相应配置，对应这个方法的四个参数。另外，也可以在<code>Biome</code>里找到<code>createWorldCarverWrapper</code>和<code>createCompositeFlowerFeature</code>。</p><p><strong>[提示]</strong> 不难看出，<code>Biome</code>和<code>Feature</code>里面都预定义了大量的实用特性、定位器，甚至还有镂空器和一些<code>protected</code>的<code>IBlockState</code>，应该尽可能多的使用它们。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="自定义结构">自定义结构<a class="hash-link" href="#自定义结构" title="Direct link to heading">​</a></h3><p>不不不，我不会真的写一个结构给你看，我只会提出几个自定义结构时所需要的注意事项：</p><ul><li><p>在<code>StructurePiece</code>里面提供了很多摆放方块的方法，请务必使用这些方法而不是直接放置，这不仅可以防止你放置到结构的外面，还会根据结构的方向对你的方块转向。</p></li><li><p>任何结构及其部分都需要在<code>StructureIO</code>进行注册，否则会导致结构无法生成并造成游戏崩溃。原版采用大写下划线的形式（如：<code>Desert_Pyramid</code>），但是我更加建议是<code>modid + &#x27;:&#x27; + 小写下划线</code>（即<code>ResourceLocation</code>）的形式，这样有助于防止模组之间发生命名冲突，并更加规范、统一。</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="自定义生物群系">自定义生物群系<a class="hash-link" href="#自定义生物群系" title="Direct link to heading">​</a></h3><p>不不不，我不会真的写一个生物群系给你看，我只会提出几个自定义生物群系时所需要的注意事项：</p><ul><li>你是不是发现许多<code>Biome</code>的构造器都有共同的代码？是的，极大的自由同时也带来了极大的工作量。好在在新的版本里面，Mojang 也意识到也改善了这一点：他们为此设置了一个类，里面装满了许多生物群系共用的特性添加的代码。这毫无疑问可以直接被我们调用，或者作为我们设置组合的参考。</li><li>出生点生物群系会被优先选中为出生点，若你的生物群系想被选中，可以直接向<code>BiomeProvider#BIOMES_TO_SPAWN_IN</code>中添加。</li><li>更多内容参见我的新教程。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="附录">附录<a class="hash-link" href="#附录" title="Direct link to heading">​</a></h2><p>下面介绍 1.13 Forge 提供的事件和钩子。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="事件">事件<a class="hash-link" href="#事件" title="Direct link to heading">​</a></h3><p>值得注意的是，原有的<code>MinecraftForge#TERRAIN_GEN_BUS</code>和<code>MinecraftForge#ORE_GEN_BUS</code>已经被移除。</p><p><code>~</code>表示上面的主事件。</p><p>值得注意的是，弃用指的不是<code>@Deprecated</code>而是简单的“存在，但是从未被使用”。</p><table><thead><tr><th>事件</th><th>描述</th></tr></thead><tbody><tr><td><code>BiomeEvent</code></td><td>生物群系相关事件<br>参见前文生物群系栏</td></tr><tr><td><code>~.GetVillageBlockID</code></td><td>获取村庄特色方块</td></tr><tr><td><code>~.BiomeColor</code></td><td>生物群系颜色相关事件<br><strong><em>新版已经弃用</em></strong><br>参见前文生物群系栏</td></tr><tr><td><code>~.GetGrassColor</code></td><td>获取草的颜色<br><strong><em>新版已经弃用</em></strong><br>参见前文生物群系栏</td></tr><tr><td><code>~.GetFoliageColor</code></td><td>获取植物的颜色<br><strong><em>新版已经弃用</em></strong><br>参见前文生物群系栏</td></tr><tr><td><code>~.GetWaterColor</code></td><td>获取水的颜色<br><strong><em>新版已经弃用</em></strong><br>参见前文生物群系栏</td></tr><tr><td><code>ChunkGeneratorEvent</code></td><td>区块生成器相关的事件<br>参见前文区块生成部分</td></tr><tr><td><code>~.ReplaceBiomeBlocks</code></td><td>替换生物群系方块<br>参见前文地表构造器栏</td></tr><tr><td><code>~.InitNoiseField</code></td><td>初始化噪声字段事件<br>参见前文高度图部分</td></tr><tr><td><code>InitNoiseGensEvent</code></td><td>噪声生成器事件<br>参见前文高度图栏</td></tr><tr><td><code>WorldTypeEvent</code></td><td>世界类型相关事件<br>参见前文世界类型栏</td></tr><tr><td><code>~.BiomeSize</code></td><td>生物群系大小时间<br>参见前文<code>GenLayer</code>的产生栏</td></tr><tr><td><code>~.InitBiomeGens</code></td><td>初始化生物群系生成（即<code>GenLayer</code>）<br><strong><em>新版已经弃用</em></strong><br>参见前文<code>GenLayer</code>的产生栏</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="钩子">钩子<a class="hash-link" href="#钩子" title="Direct link to heading">​</a></h3><table><thead><tr><th>钩子</th><th>描述</th></tr></thead><tbody><tr><td><code>TerrainGen#getModdedNoiseGenerators</code></td><td>获取模组修改后的噪声生成器</td></tr><tr><td><code>LayerUtil#getModdedBiomeSize</code></td><td>获取模组修改后的生物群系大小</td></tr><tr><td><code>ForgeEventFactory#onReplaceBiomeBlocks</code></td><td>构造模组修改后的地表</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="后记">后记<a class="hash-link" href="#后记" title="Direct link to heading">​</a></h2><p>本来这个介绍是附在我的《浅析 1.13 Minecraft - MCP | Forge - FML》里面的，不过我后来直接放弃了那个项目，专心投身于这个部分。</p><p>1.13 Mojang 做出的努力使我眼前一亮，世界生成可以说是最重要的一部分，Mojang 迈出了第一步，希望这不是最后一步。</p><p>我这篇文章写的我很艰辛，大量未反混淆的的代码和 Mojang 奇怪的脑回路使我感到痛苦，但是我还是在最短的时间内肝出这篇文章，不出意外，是世界上第一篇（中文）新版地形生成解析。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="鸣谢">鸣谢<a class="hash-link" href="#鸣谢" title="Direct link to heading">​</a></h2><ul><li>MCP 对 Minecraft 源代码的反混淆，如果不是他们，我也不能写出这篇文章。</li><li>森林蝙蝠 审读并提出来让我加入的结构的部分。</li><li>33 让我加入浅析新版本世界生成与旧版本的本质区别和好处分析一栏。</li><li>素学姐 和 3T 对教程提出的宝贵建议。</li><li>感谢 chyx 指出我文章中一系列的谬误。</li><li>土球（ustc_zzzz）制作的 <a href="https://mm2bc.ustc-zzzz.net/" target="_blank" rel="noopener noreferrer">BBCode 转换器</a>，为当初发布到 MCBBS 提供了便利。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考">参考<a class="hash-link" href="#参考" title="Direct link to heading">​</a></h2><p>按参考内容质量、数量降序排列：</p><ul><li>Minecraft 1.13.2 源代码 - 反编译、反混淆 by MCP 快照 20180921-1.13</li><li>MinecraftForge 1.13.2-25.0.10 源代码</li><li>Minecraft 旧版（1.12.2）源码 - 反编译、反混淆 by MCP </li><li>MinecraftForge 旧版（1.12.2-14.23.5.2768）源代码</li><li>Minecraft 维基百科 - 英文、中文相关页面</li><li>土球的旧版本地形生成解析</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="相关链接">相关链接<a class="hash-link" href="#相关链接" title="Direct link to heading">​</a></h2><ul><li><a href="http://www.mcbbs.net/thread-811614-1-1.html" target="_blank" rel="noopener noreferrer">海螺的水桶地形生成解析（MCBBS）</a></li><li><a href="https://www.zhihu.com/question/20754279/answer/133715741" target="_blank" rel="noopener noreferrer">土球的旧版本地形生成解析（知乎）</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/site/docs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">香肠的文档站</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/site/docs/biome"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">再析世界生成：生物群系</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#摘要" class="table-of-contents__link toc-highlight">摘要</a></li><li><a href="#引子为什么" class="table-of-contents__link toc-highlight">引子：为什么？</a></li><li><a href="#区块生成概述" class="table-of-contents__link toc-highlight">区块生成概述</a></li><li><a href="#区块生成任务" class="table-of-contents__link toc-highlight">区块生成任务</a><ul><li><a href="#基础" class="table-of-contents__link toc-highlight">基础</a></li><li><a href="#镂空流体镂空" class="table-of-contents__link toc-highlight">镂空、流体镂空</a></li><li><a href="#装饰" class="table-of-contents__link toc-highlight">装饰</a></li><li><a href="#光照" class="table-of-contents__link toc-highlight">光照</a></li><li><a href="#生物生成" class="table-of-contents__link toc-highlight">生物生成</a></li><li><a href="#收尾" class="table-of-contents__link toc-highlight">收尾</a></li><li><a href="#完整区块处理后" class="table-of-contents__link toc-highlight">完整区块、处理后</a></li></ul></li><li><a href="#结束了结束了" class="table-of-contents__link toc-highlight">结束了？结束了。</a></li><li><a href="#生物群系" class="table-of-contents__link toc-highlight">生物群系</a></li><li><a href="#结构生成" class="table-of-contents__link toc-highlight">结构生成</a><ul><li><a href="#buildcomponent" class="table-of-contents__link toc-highlight"><code>buildComponent</code></a></li><li><a href="#addcomponentparts" class="table-of-contents__link toc-highlight"><code>addComponentParts</code></a></li></ul></li><li><a href="#模板" class="table-of-contents__link toc-highlight">模板</a><ul><li><a href="#调色盘" class="table-of-contents__link toc-highlight">调色盘</a></li><li><a href="#templatestructurepiece" class="table-of-contents__link toc-highlight"><code>TemplateStructurePiece</code></a></li></ul></li><li><a href="#维度与世界类型" class="table-of-contents__link toc-highlight">维度与世界类型</a></li><li><a href="#应用自定义" class="table-of-contents__link toc-highlight">应用：自定义</a><ul><li><a href="#自定义矿物生成" class="table-of-contents__link toc-highlight">自定义矿物生成</a></li><li><a href="#自定义结构" class="table-of-contents__link toc-highlight">自定义结构</a></li><li><a href="#自定义生物群系" class="table-of-contents__link toc-highlight">自定义生物群系</a></li></ul></li><li><a href="#附录" class="table-of-contents__link toc-highlight">附录</a><ul><li><a href="#事件" class="table-of-contents__link toc-highlight">事件</a></li><li><a href="#钩子" class="table-of-contents__link toc-highlight">钩子</a></li></ul></li><li><a href="#后记" class="table-of-contents__link toc-highlight">后记</a></li><li><a href="#鸣谢" class="table-of-contents__link toc-highlight">鸣谢</a></li><li><a href="#参考" class="table-of-contents__link toc-highlight">参考</a></li><li><a href="#相关链接" class="table-of-contents__link toc-highlight">相关链接</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Quick Access</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://yaossg.com/end-poem/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Online End Poem<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Related Sites</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://yaossg.com/doc/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Yaossg&#x27;s Alternative Doc<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Yaossg's Site</div></div></div></footer></div>
<script src="/site/assets/js/runtime~main.b1ff4dae.js"></script>
<script src="/site/assets/js/main.12a8b356.js"></script>
</body>
</html>